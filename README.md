"# tbank_sirius_cv" 
## Задачка выбрана 3 на CV.

### Уточнения по запуску кода
В файлике requirements.txt поидее есть все зависимости, но ipnb лучше запускать в colab

для raw_desc нужно res_data.zip, для norm_desc нужно raw_descriptions.csv

для модельки gemma нужна авторизация на hugging face и в самой модельке тоже немного, на всякий случай в коментарии оставлен токен с которого я регался, в этом случае просто вводите этот токен(токен от пустого акаунта, так что ладно)

### УДАЛЕНИЕ ФОНА
Ну так как никакого набора для обучения не было предоставлено, а датасеты в интернете искать лень,
чтобы удалить фон с картинки(хотя на 80% фотографий он и так белый) будем использовать библиотеку rem_bg.

Работает через сессии как то(особо в них не разбирался) моделька unet вроде, обычная сегментация

Сходу работала не плохо, поэтому решил оставить все так, хотя там была еще моделька специально для одежды, если улучшать решение то можно будет и ее потестить

Реализовать оценку сегментации можно с помощью метрики Iou(пересеч на обьед), а также размеченного датасета из интернета(жаль мне лень было его искать, да забить в гугле очень лень)

### ЗАМЕНА ФОНА
Цвет фона можно поставить в коде, автоматически берется средний по картинке цвет пикселей


### ГЕНЕРАЦИЯ ОПИСАНИЯ
Вот тут уже у меня все вышло сложнее, изначально попробовал blip, но генерировал он так себе даже на large + главная проблема в том что в него нельзя запихать нормально промпт,
тоесть в него можно передать текст, но он его просто в начало поставит и будет пытаться его продолжить, что не очень ведь описывать он будет саму картинку а не товар на ней, и если это описание еще обрабатывать дальше то вообще ниче мне каж не получится

В теории это можно решить если зафайтюнить blip на каком нибудь датасете где именно описание товара

Ну потыкав еще несколько моделек описания картинок, где можно указывать промпт у меня мало, что получилось(конечно же есть модели которые могут это сделать, но у меня они в оперативку в colab не влезали, мб что то не так делал)

Короче пришел к выводу, что сделаю сначала просто описание картинки, а потом с помощью текстовой модельки на основе этого описания сделаю уже нормальное маркетинговое, заодно еще и на русский переведу(спойлер на русский все равно пришлось переводить отдельно). Просто описание сделал моделькой CogFlorence-2.2-Large, у нее есть 3 режима DETAILED, More_detailed, и обычное, ну потестив выбрал среднее DETAILED, хотя мне кажется проще было бы обычное.

Дальше я хотел взять текстовую модель которая может и на русский сразу перевести, но не повезло не фартануло, нашлась только gemma-2-2b-it, которая просто на основе моего корявого промпта составила нормальное описание, все также на английском

Чтобы генерировать описания какие тебе надо, просто укажи это в промпте к этой модельке

Дальше притворюсь, что про русский язык ничего сказано не было, и не буду приводить код который бы нормально все сгенерированное переводил на русский(потому что как оказалось во всех api которые я нашел надо указывать данные банковской карты, а те же модельки с hugging face не справлялись с переводом)

Вобщем с помощью магии это все переводится на русский язык и получается итоговое описание в файлике rus_descriptions в колонке rus_desc, имена картинок в file_names

Да, не идеально но все же

Вообще, конечно так много шагов(3), которые можно было бы заменить одним(сразу описывая картинку на русском и маркетингово) не очень хорошо, ведь теряется качество, но я описал, почему пришел к этому

Качество текста, описывающего товар можно измерить, найдя соответствующий датасет в интернете и по метрике METEOR или BLEU.